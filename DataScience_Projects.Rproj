#part 1.a
#1. Remove extra spaces from below string using R
#   "Virtual classrooms are very different from their physical counterparts."
#   Copy this string in R and write code to return string with no extra spaces.
#   Output should look like shown below
#   "Virtual classrooms are very different from their physical counterparts."
#(code)

string<-"Virtual classrooms  are very different from    their physical counterparts. "
string<-trimws(gsub("\\s+"," ",string))
string

#part 1.b
#Write code to divide mentioned skills in 3 categories and export to excel file.
# a. bad (score 0-30)
# b. average (score 31-70)
# c. good (score 71-100) 
#(code)

Skill<-c('Skill_1','Skill_2','Skill_3','Skill_4','Skill_5')
Score<-c(18,60,80,50,40)
df<-data.frame(Skill,Score)
df
grade<-function(x){
  if(0<x & x<30)
  {
    result<-"Bad"
  }else if(31<x & x<70)
  {
    result<-"Average"
  }else if(71<x & x<100)
  {
    result<-"Good"
  }else {
    result<-"Error"
  }
  print(result)
}
df$Skill_score_categories<-lapply(X= df$Score , FUN= grade)
df
#install.packages("rio")
setwd("c:\\")
library(rio)
library(dplyr)
library(openxlsx)
export(df,"r_assignment_part1b.xlsx")

# 1.c Extract by mentioning pattern (regular expressions)

library(stringr)
sentence<-"(15_Q_EVA_TP2_001)Evaluating students holistically is a big responsibility. Please mark your 
rating for following teacher(s) on the scale of 1-5 who evaluates students appropriately and 
gives them required feedback."
sentence1<-str_extract(string=sentence,pattern="\\(\\d\\d_\\w_\\w\\w\\w_\\w\\w\\d_\\d\\d\\d\\)")
sentence2<-str_remove(string=sentence,pattern="\\(\\d\\d_\\w_\\w\\w\\w_\\w\\w\\d_\\d\\d\\d\\)")
print(sentence1)
print(sentence2)
#   .....................................................................................

#Part 2
#  Suppose string is "Malayalam is the principal language of kerala"
#  Write code to return palindrome in the string. Here palindrome is "Malayalam" thus code 
#  should return word Malayalam.

Clean_String <- function(string){
  temp <- tolower(string)
  temp <- stringr::str_replace_all(temp,"[^a-zA-Z\\s]", " ")
  temp <- stringr::str_replace_all(temp,"[\\s]+", " ")
  temp <- stringr::str_split(temp, " ")[[1]]
  indexes <- which(temp == "")
  if(length(indexes) > 0){
    temp <- temp[-indexes]
  } 
  return(temp)
}
sentence <- "Malayalam is the principal language of kerala"
clean_sentence <- Clean_String(sentence)
print(clean_sentence)
#install.packages("stringr")
library(stringr)
is_palindrome <- function(w){
  charsplit <- strsplit(w, "")[[1]]
  revchar <- rev(charsplit)
  all(charsplit==revchar)
}
i=1
while(i<=length(clean_sentence)){
  word=clean_sentence[i]
  if(is_palindrome(word)){
    print(word) 
  }
  i=i+1
}
#  ...................................................................................

#part 3 is in another file. Please refer myworkspace RData for Rtest file2 for part3
